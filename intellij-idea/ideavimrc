" -*- mode: vimrc -*-

let mapleader = " "

" Selected Intellimacs modules
source ~/.intellimacs/spacemacs/buffers.vim
source ~/.intellimacs/spacemacs/help.vim
source ~/.intellimacs/spacemacs/misc.vim
source ~/.intellimacs/spacemacs/search-symbol.vim
source ~/.intellimacs/hybrid.vim

" My own vim commands
set clipboard+=unnamed
set commentary
set easymotion
set history
set ideajoin=true
set idearefactormode=visual
set ignorecase
set matchpairs
set multiple-cursors
set number
set relativenumber
set smartcase
set surround
set wrapscan

" +buffer
noremap <Leader>bK :<C-u>qa!<CR>
noremap <Leader>bO :<C-u>action CloseAllEditorsButActive<CR>
noremap <Leader>bS :<C-u>wa<CR>
noremap <Leader>bd :<C-u>q!<CR>
noremap <Leader>bk :<C-u>q!<CR>
noremap <Leader>bs :<C-u>w<CR>

" +code
noremap <Leader>cD :<C-u>action ShowUsages<CR>
noremap <Leader>ca :<C-u>action ShowIntentionActions<CR>
noremap <Leader>cd gd
noremap <Leader>cf :<C-u>action ReformatCode<CR>
noremap <Leader>ci :<C-u>action OptimizeImports<CR>
noremap <Leader>ck :<C-u>action QuickJavaDoc<CR>
noremap <Leader>cr :<C-u>action RenameElement<CR>

" +file
noremap <Leader>fr :<C-u>action RecentFiles<CR>
noremap <Leader>fs :<C-u>w<CR>


"
" +git

nnoremap <Leader>g[ :<C-u>action VcsShowPrevChangeMarker<CR> " Jump to previous hunk
nnoremap <Leader>g] :<C-u>action VcsShowNextChangeMarker<CR> " Jump to next hunk
noremap <Leader>gb :<C-u>action Git.Branches<CR>             " Switch branch
noremap <Leader>gg :<C-u>action Git.Menu<CR>
noremap <Leader>gr :<C-u>action Vcs.RollbackChangedLines<CR> " Revert hunk
noremap <Leader>gB :<C-u>action Annotate<CR>                 " Blame
noremap <Leader>gF :<C-u>action Git.Fetch<CR>                " Fetch
noremap <Leader>gS :<C-u>action Git.Add<CR>                  " Git stage file
" +create
noremap <Leader>gcp :<C-u>Github.Create.Pull.Reqeust<CR>     " Pull request
" +find
noremap <Leader>gfp :<C-u>Github.View.Pull.Reqeust<CR>       " Find pull request
" +open in-browser
noremap <Leader>goo :<C-u>action Github.Open.In.Browser<CR>  " Browse file or region
" This requires Find Pull Request plugin
noremap <Leader>gop :<C-u>com.github.shiraji.findpullrequest.action.FindPullRequestAction " Browse a pull request

nnoremap [d :<C-u>action VcsShowPrevChangeMarker<CR>
nnoremap ]d :<C-u>action VcsShowNextChangeMarker<CR>


" +insert
nnoremap <Leader>is :<C-u>action InsertLiveTemplate<CR>
vnoremap <Leader>is <Esc>:<C-u>action InsertLiveTemplate<CR>

" +open
noremap <Leader>oP :<C-u>action SelectInProjectView<CR>

" +project
noremap <Leader>pp :<C-u>action ManageRecentProjects<CR>
noremap <Leader>pt :<C-u>action ActivateTODOToolWindow<CR>

" +window
noremap <Leader>wW <C-w>W
noremap <Leader>wc <C-w>c
noremap <Leader>wd <C-w>c
noremap <Leader>wh <C-w>h
noremap <Leader>wj <C-w>j
noremap <Leader>wk <C-w>k
noremap <Leader>wl <C-w>l
noremap <Leader>ws <C-w>s
noremap <Leader>wv <C-w>v
noremap <Leader>ww <C-w>w


" +evil-easymotion
" This requires AceJump and IdeaVim-EasyMotion plugins
map gss <Plug>(easymotion-s2)


" expand-region
noremap <C-S-=> :<C-u>action EditorSelectWord<CR>
noremap <C-=> :<C-u>action EditorUnSelectWord<CR>


" Previous/next method
nnoremap [[ :<C-u>action MethodUp<CR>
nnoremap ]] :<C-u>action MethodDown<CR>

" Insert line above/below
nnoremap [<Space> o<Esc>k
vnoremap [<Space> <Esc>o<Esc>k
nnoremap ]<Space> O<Esc>j
vnoremap ]<Space> <Esc>O<Esc>j

" Go to previous/next error
nnoremap [e :<C-u>action GotoPreviousError<CR>
nnoremap ]e :<C-u>action GotoNextError<CR>

" Previous/next tab
noremap <A-Left> :<C-u>action PreviousTab<CR>
noremap <A-Right> :<C-u>action NextTab<CR>

nnoremap <Esc> :<C-u>nohl<CR><Esc>
imap jk <Esc>
vmap jk <Esc>

" Retain visual-mode on selection shift
vnoremap < <gv
vnoremap > >gv
