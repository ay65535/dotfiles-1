#!/bin/sh

# xmobar-cpu-usage
# author: Seong Yong-ju <sei40kr@gmail.com>

S_TIME_FORMAT=ISO mpstat -P ALL 1 | awk '
$2 == "all" {
  idle = $12 + 0
  usage = int(100 - idle)

  s = "<fn=3>ï¬™</fn><fn=1>  </fn>" usage "%"

  if (30 <= usage) {
    if (usage <= 80) color = "#cc8000"
    else             color = "#cc0080"

    s = "<fc=" color ">" s "</fc>"
  }

  print s
  fflush()
}'
